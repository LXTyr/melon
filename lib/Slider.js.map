{"version":3,"sources":["Slider.js"],"names":["cx","Slider","props","context","onMouseDown","bind","onMouseUp","onMouseChange","maximum","minimum","value","state","active","componentWillUnmount","slider","off","window","setState","e","clientX","step","newValue","onSliderChange","onChange","type","target","disable","readOnly","on","getSliderValue","renderHiddenInput","renderBar","findDOMNode","render","validity","width","style","className","addStates","getStyleStates","build","displayName","defaultProps","defaultValue","height","propTypes","number","oneOfType","string","pointerSize"],"mappings":"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","file":"Slider.js","sourcesContent":["/**\n * @file melon/Slider\n * @author cxtom <cxtom2008@gmail.com>\n */\n\nimport React, {PropTypes} from 'react';\nimport ReactDOM from 'react-dom';\n\nimport InputComponent from 'melon-core/InputComponent';\nimport Validity from 'melon-core/Validity';\nimport {create} from 'melon-core/classname/cxBuilder';\nimport domUtil from './common/util/dom';\n\nimport SliderBar from './slider/Bar';\nimport getNewValue from './slider/getNewValue';\n\nconst cx = create('Slider');\n\n\n/**\n * melon/Slider\n *\n * @extends {melon-core/InputComponent}\n * @class\n */\nexport default class Slider extends InputComponent {\n\n    /**\n     * 构造函数\n     *\n     * @public\n     * @constructor\n     * @param  {*} props   属性\n     * @param  {*} context 上下文\n     */\n    constructor(props, context) {\n\n        super(props, context);\n\n        this.onMouseDown = this.onMouseDown.bind(this);\n        this.onMouseUp = this.onMouseUp.bind(this);\n        this.onMouseChange = this.onMouseChange.bind(this);\n\n        const {maximum, minimum} = props;\n        const value = this.state.value;\n\n        this.state.value = value > maximum ? maximum : value;\n        this.state.value = value < minimum ? minimum : value;\n\n        /**\n         * 状态\n         *\n         * @protected\n         * @type {Object}\n         */\n        this.state = {\n            ...this.state,\n            active: false\n        };\n    }\n\n    /**\n     * 将要Unmount时的处理\n     *\n     * @public\n     * @override\n     */\n    componentWillUnmount() {\n\n        /**\n         * bar\n         *\n         * @protected\n         * @type {HTMLElement}\n         */\n        this.slider = null;\n    }\n\n    /**\n     * 鼠标抬起时的处理\n     *\n     * @protected\n     */\n    onMouseUp() {\n        domUtil.off(window, 'mouseup', this.onMouseUp);\n        domUtil.off(window, 'mousemove', this.onMouseChange);\n        this.setState({active: false});\n    }\n\n    /**\n     * 鼠标移动时的处理\n     *\n     * @protected\n     * @param  {{clientX: number}} e 事件对象\n     */\n    onMouseChange(e) {\n\n        const clientX = e.clientX;\n\n        const {maximum, minimum, step} = this.props;\n        const value = this.state.value;\n\n        const newValue = getNewValue(this.slider, clientX, maximum, minimum, step);\n\n        if (value === newValue || newValue > maximum || newValue < minimum) {\n            return;\n        }\n\n        this.onSliderChange(newValue);\n    }\n\n    /**\n     * 数值改变时调用\n     *\n     * @protected\n     * @param  {number} newValue 新值\n     */\n    onSliderChange(newValue) {\n        super.onChange({\n            type: 'change',\n            target: this,\n            value: newValue\n        });\n    }\n\n    /**\n     * 鼠标按下时的处理\n     *\n     * @protected\n     * @param  {Object} e 事件对象\n     * @return {undefined}\n     */\n    onMouseDown(e) {\n\n        if (this.props.disable || this.props.readOnly) {\n            return;\n        }\n\n        domUtil.on(window, 'mouseup', this.onMouseUp);\n        domUtil.on(window, 'mousemove', this.onMouseChange);\n        this.onMouseChange(e);\n\n        this.setState({active: true});\n    }\n\n    /**\n     * 获得当前值\n     *\n     * @public\n     * @return {number} 当前值\n     */\n    getSliderValue() {\n        return this.state.value;\n    }\n\n    /**\n     * 渲染input\n     *\n     * @protected\n     * @return {ReactElement}\n     */\n    renderHiddenInput() {\n\n        const value = this.state.value;\n\n        return (\n            <input\n                type=\"hidden\"\n                value={value} />\n        );\n    }\n\n    /**\n     * 渲染bar\n     *\n     * @protected\n     * @return {ReactElement}\n     */\n    renderBar() {\n\n        return (\n            <SliderBar\n                {...this.props}\n                ref={slider => {\n                    this.slider = ReactDOM.findDOMNode(slider);\n                }}\n                active={this.state.active}\n                onMouseDown={this.onMouseDown}\n                value={this.getSliderValue()} />\n        );\n    }\n\n    /**\n     * 渲染\n     *\n     * @public\n     * @return {ReactElement}\n     */\n    render() {\n\n        const validity = this.state.validity;\n\n        /* eslint-disable fecs-minimum-vars-per-destructure */\n\n        const {\n            width,\n            style = {}\n        } = this.props;\n\n        const className = cx(this.props)\n            .addStates(this.getStyleStates())\n            .build();\n\n        return (\n            <div\n                style={{...style, width}}\n                className={className}>\n                {this.renderHiddenInput()}\n                {this.renderBar()}\n                <Validity validity={validity} />\n            </div>\n        );\n\n    }\n}\n\nSlider.displayName = 'Slider';\n\nSlider.defaultProps = {\n    ...InputComponent.defaultProps,\n    defaultValue: 0,\n    maximum: 100,\n    minimum: 0,\n    step: 1,\n    width: '100%',\n    height: 2\n};\n\nSlider.propTypes = {\n    ...InputComponent.propTypes,\n    defaultValue: PropTypes.number,\n    value: PropTypes.number,\n    maximum: PropTypes.number,\n    minimum: PropTypes.number,\n    width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    pointerSize: PropTypes.oneOfType([PropTypes.number, PropTypes.string])\n};\n"]}